clear;
clc;
close all;

A  =[
13.5917  24.1500 -36.4750 
 13.5917  24.1083 -36.4333 
 13.4750  24.4750 -36.0917 
 13.5167  25.1917 -35.1500 
 13.5000  24.9667 -35.6667 
 13.1500  24.3167 -36.4583 
 13.0250  23.5083 -37.1500 
 12.3500  22.7583 -37.7583 
 12.0083  21.8833 -38.0250 
 11.7250  21.3167 -38.0667 
 11.4250  20.6667 -37.8417 
 11.1667  20.1917 -37.4750 
 10.7500  19.7167 -37.0500 
 10.3583  19.1917 -36.0250 
 10.2750  18.4750 -34.5500 
 10.2583  18.3000 -33.0167 
 10.2583  17.9167 -31.6917 
 10.3000  17.7750 -30.1833 
 10.3000  17.6833 -27.8167 
 10.3167  17.8750 -24.5250 
 10.6250  18.7250 -20.7750 
 10.8417  19.5417 -17.9250 
 11.1000  20.5500 -15.3833 
 11.1833  21.2500 -13.5667 
 11.1667  22.2667 -12.0833 
 11.1000  23.0083 -11.0833 
 11.1250  23.5083 -10.5250 
 10.7667  23.5083 -10.5500 
 10.1000  22.9417 -11.4667 
  9.3417  22.2917 -12.7667 
  8.3750  21.5667 -14.7667 
  7.2667  21.0250 -17.4750 
  6.5667  20.8417 -19.4333 
  5.8583  20.9333 -21.3833 
  5.3000  21.2250 -22.8333 
  4.9417  21.4583 -23.8750 
  4.6250  21.9000 -24.8917 
  4.4583  22.3333 -25.6833 
  4.3000  22.7333 -26.2333 
  4.1750  23.1417 -25.6000 
  4.0000  23.4583 -25.1083 
  4.0417  23.8000 -25.2167 
  3.9167  24.1083 -25.1083 
  3.9750  24.3833 -24.6000 
  3.9750  24.3833 -23.8750 
  4.0417  24.6083 -22.2500 
  4.3583  25.3500 -20.0833 
  4.4333  26.1417 -19.8417 
  5.0167  27.2250 -18.9833 
  5.5833  28.2167 -18.8167 
  6.1417  28.9583 -19.6500 
  6.8083  29.5917 -21.0833 
  7.7667  29.8833 -22.4417 
  8.3917  29.8833 -24.5833 
  9.0583  29.7250 -26.3917 
  9.6250  29.3167 -28.1083 
  9.7750  28.9167 -29.6917 
 10.2250  28.3333 -31.4417 
 10.6417  27.7667 -32.8083 
 11.4667  26.9750 -34.1917 
 12.3750  25.9333 -35.4250 
 13.1750  25.2167 -36.1750 
 14.5000  24.2083 -36.1083 
 15.5833  23.2083 -35.7083 
 16.2917  22.5417 -34.7083 
 16.7917  21.4750 -33.6333 
 17.0083  20.7083 -32.4667 
 16.9833  20.0583 -31.3083 
 16.5667  19.3333 -30.6500 
 16.1250  18.7667 -29.3917 
 15.4833  18.3417 -28.1083 
 14.6000  17.9583 -27.7083 
 12.9583  17.6417 -27.5167 
 11.2917  17.6000 -27.5833 
 10.2083  17.7333 -27.8417 
  9.4000  17.9333 -28.5000 
  8.5000  18.5500 -31.9333 
  8.5000  19.6500 -36.1333 
  8.5167  21.2083 -37.6833 
  8.6917  22.7333 -38.5000 
  9.1917  24.2250 -38.1083 
  9.5417  25.4417 -37.1750 
  9.9000  27.0167 -35.0500 
 10.5833  27.9667 -33.1667 
 11.4667  28.4167 -31.6917 
 12.5083  28.9333 -29.4333 
 13.5583  29.2750 -27.3333 
 14.7583  29.6833 -23.8083 
 15.4417  29.6833 -19.3500 
 15.9250  29.0500 -15.3000 
 15.7500  28.2333 -12.5083 
 15.1833  27.3833 -10.7583 
 14.4167  26.4750  -9.5667 
 13.8750  25.5250  -9.2667 
 12.9750  24.6750  -9.3917 
 12.2083  24.5167  -9.3083 
 11.4000  24.1500  -9.6500 
 10.3583  24.5417  -9.4583 
  9.0833  24.8833 -10.1250 
  7.9583  24.9250 -10.9750 
  7.2500  24.8333 -11.8917 
  6.6083  25.2917 -12.9167 
  5.6667  25.7750 -14.8750 
  5.3417  26.6333 -17.1917 
  5.3167  27.5000 -19.4583 
  5.7083  28.0417 -22.0167 
  6.4000  28.4667 -24.3833 
  7.3500  28.4417 -26.3000 
  8.5417  28.1417 -29.0917 
  9.8833  27.7667 -31.0833 
 11.0083  27.0167 -32.8083 
 12.1083  26.1417 -34.1083 
 13.1083  25.4250 -34.8083 
 14.0167  24.7500 -35.0500 
 14.8167  24.0667 -34.9333 
 15.5833  23.5500 -34.4000 
 16.1833  23.2083 -33.7667 
 16.5500  22.8750 -33.1833 
 16.8500  22.4000 -32.7667 
 16.7667  21.8583 -32.6750 
 16.3083  21.7250 -33.3833 
 16.0833  21.6500 -33.7917 
 15.9833  21.2083 -33.8500 
 15.8000  20.4583 -33.3000 
 15.7667  19.8750 -32.8333 
 15.3583  19.1917 -31.3333 
 15.0833  18.7667 -29.3917 
 14.6917  18.5000 -27.0250 
 14.5167  18.6083 -25.0917 
 14.0583  18.9000 -23.0000 
 13.6917  19.3833 -20.0167 
 13.5583  20.3917 -16.9000 
 14.0583  21.5417 -14.3583 
 14.5417  23.0833 -12.9583 
 14.7167  24.3583 -11.6333 
 14.0583  25.5250 -10.4667 
 12.9750  26.3417  -9.6333 
 12.7667  26.5667  -9.6500 
 13.0250  26.5250  -9.8000 
 13.5417  26.1417  -9.9417 
 13.6917  26.3167 -10.1250 
 13.8500  26.4750 -10.2250 
 13.6500  27.0000  -9.9833 
 14.3000  27.0417 -10.6083 
 14.9000  27.2500 -11.2250 
 15.3583  27.6750 -12.3000 
 16.1833  28.0417 -13.9750 
 16.5250  28.3500 -16.3417 
 16.6250  28.6250 -18.7583 
 16.6417  28.4667 -21.1000 
 16.3583  28.3917 -23.8750 
 15.9417  28.0583 -26.3417 
 15.1833  27.7917 -29.1250 
 14.1917  27.3583 -31.4667 
 13.9583  27.0917 -32.4000 
 13.2583  26.7667 -33.6667 
 11.7250  26.5000 -35.3583 
 10.3167  26.2583 -36.1333 
  9.6917  26.2083 -36.1333 
  8.9167  25.8917 -36.2583 
  7.8500  27.0667 -33.9750 
  7.0917  28.0083 -31.2083 
  6.5667  28.8750 -28.0083 
  6.5500  29.3833 -25.3833 
  6.7917  29.7500 -21.8500 
  6.5500  29.6333 -18.2500 
  7.0083  29.3833 -15.0500 
  7.3500  28.9750 -13.1667 
  7.7167  28.1417 -11.5083 
  8.0000  27.3417 -10.4833 
  8.2750  26.5250 -10.0833 
  8.5167  25.7333  -9.9833 
  8.7750  25.1250  -9.9000 
  8.7583  24.8500 -10.0417 
  8.8000  24.6917 -10.2500 
  9.0833  25.8917  -9.6083 
  9.8167  28.0833  -9.6500 
 10.0417  29.0500 -10.8417 
 11.1250  29.7083 -11.8917 
 11.3583  30.4667 -15.0083 
 11.6833  30.4833 -20.9750 
 12.1500  29.4750 -26.5583 
 12.2667  28.5500 -29.5917 
 12.4833  27.2250 -32.5917 
 12.6917  25.8000 -34.9583 
 12.9333  23.2333 -37.0667 
 12.9750  21.3000 -37.0500 
 12.4833  19.7167 -36.2333 
 12.0917  19.0000 -35.3000 
 11.4667  18.6500 -34.3833 
 10.7250  18.2250 -33.2333 
  9.9750  18.1417 -31.8750 
  9.1000  18.1833 -30.6917 
  7.8750  18.8417 -30.3917 
  7.5083  18.9250 -28.6250 
  7.5250  19.1500 -24.9583 
  7.9167  19.7583 -20.7583 
  8.0000  20.4167 -18.6000 
  8.0500  21.3833 -16.4333 
  8.1500  22.5083 -14.5583 
  8.5417  23.4750 -12.7667 
  9.1500  24.5583 -11.2250 
  9.9250  25.4667 -10.1833 
 11.0083  26.3000  -9.5000 
 12.2083  26.9750  -9.5500 
 13.3500  26.9750  -9.8167 
 14.6000  26.6833 -10.3917 
 15.9250  26.8000 -11.4833 
 16.5667  27.0667 -12.6917 
 16.1250  27.4667 -12.4833 
 15.4833  27.1500 -11.3500 
 15.4250  26.0667 -10.6917 
 15.3417  25.6417 -10.7167 
 15.3000  25.0167 -10.5917 
 15.2333  24.8083 -10.8167 
 15.3583  24.7500 -10.8417 
 14.6250  25.6417  -9.9250 
 13.8167  26.3417  -9.4583 
 13.0000  26.6333  -9.1250 
 12.7500  26.8000  -8.9417 
 11.8750  27.0167  -8.9833 
 10.4000  26.7500  -9.2250 
 10.9417  25.6417  -8.9250 
 12.3500  24.8500  -9.3333 
 14.2583  24.0000 -10.3917 
 15.9000  23.4167 -12.6083 
 17.6333  22.5833 -16.6833 
 18.2167  21.8833 -21.1667 
 18.2167  21.4000 -26.0083 
 17.7167  21.2250 -29.0917 
 16.6667  21.3000 -32.4667 
 15.0417  21.9250 -35.6417 
 13.2333  23.1417 -37.0500 
 11.3833  24.4750 -36.9417 
  9.5833  25.3333 -36.1500 
  7.5500  25.9333 -34.6833 
  5.7917  25.8500 -32.3833 
  4.4583  24.9833 -29.9417 
  4.0167  23.5917 -27.7250 
  4.8167  21.5667 -23.7500 
  6.4417  20.6833 -20.3917 
  8.2750  20.7083 -17.0083 
  9.3417  20.5917 -16.5000 
 10.7250  20.0250 -16.7917 
 12.2667  19.9667 -16.8417 
 13.5917  20.1417 -16.6250 
 14.3833  20.3000 -16.5583 
 15.5167  20.7083 -16.9667 
 16.5083  21.3417 -17.1333 
 17.0500  22.0583 -16.8417 
 17.5083  22.8333 -16.6417 
 17.5917  23.0833 -16.3917 
 17.4167  23.4167 -15.5583 
 16.8083  23.8000 -13.6833 
 14.3417  24.4250 -10.5667 
 14.1000  23.9583 -11.0167 
 14.6917  24.0500 -11.0583 
 14.5833  24.7167 -10.6083 
 14.7167  25.0167 -10.4833 
 14.5583  25.1750 -10.2250 
 14.3833  26.2583  -9.8833 
 14.4167  26.7083 -10.0167 
 13.9583  25.4417  -9.8583 
 13.1500  24.0167 -10.1833 
 11.7500  23.7750 -10.3750 
 11.8750  22.5083 -11.5917 
 12.3333  21.4333 -13.3167 
 13.2333  21.3417 -13.9583 
 13.3750  21.5917 -13.3417 
 13.8500  21.8083 -13.2333 
 13.7750  22.0417 -11.6750 
];


plot3(A(:,1), A(:,2), A(:,3), '.');
axis equal

[A, b, expmfs] = magcal(A, 'auto')
