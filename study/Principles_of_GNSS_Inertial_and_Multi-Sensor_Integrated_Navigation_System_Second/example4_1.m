clear;
clc
close all;

%%
% EXAMPLE 4.1
% Accelerometer error

%% INTPUS 
data = [
-10 0.397742675 3.98E-05 -10.0005 -4.6023E-04
-9.5 0.558802485 5.59E-05 -9.5004 -3.6912E-04
-9 0.770081799 7.70E-05 -9.0003 -2.7299E-04
-8.5 -0.194965271 -1.95E-05 -8.5003 -2.9450E-04
-8 -0.046517708 -4.65E-06 -8.0002 -2.0465E-04
-7.5 -0.000629954 -6.30E-08 -7.5001 -1.2506E-04
-7 -1.824940824 -1.82E-04 -7.0002 -2.3249E-04
-6.5 2.20461415 2.20E-04 -6.4998 2.4546E-04
-6 1.314101963 1.31E-04 -5.9998 2.3141E-04
-5.5 -0.385305185 -3.85E-05 -5.4999 1.3647E-04
-5 0.250276604 2.50E-05 -4.9997 2.7503E-04
-4.5 2.106908507 2.11E-04 -4.4995 5.3569E-04
-4 -0.342451965 -3.42E-05 -3.9996 3.6575E-04
-3.5 0.952660688 9.53E-05 -3.4994 5.7027E-04
-3 0.803109111 8.03E-05 -2.9994 6.3031E-04
-2.5 0.817147144 8.17E-05 -2.4993 7.0671E-04
-2 0.969075871 9.69E-05 -1.9992 7.9691E-04
-1.5 0.114369628 1.14E-05 -1.4992 7.8644E-04
-1 0.785133294 7.85E-05 -0.9991 9.2851E-04
-0.5 0.216555609 2.17E-05 -0.4991 9.4666E-04
0 -0.355914306 -3.56E-05 0.0010 9.6441E-04
0.5 -0.049967677 -5.00E-06 0.5011 1.0700E-03
1 0.267134159 2.67E-05 1.0012 1.1767E-03
1.5 -0.503027161 -5.03E-05 1.5012 1.1747E-03
2 -0.371066725 -3.71E-05 2.0013 1.2629E-03
2.5 0.166377355 1.66E-05 2.5014 1.3916E-03
3 -2.194273588 -2.19E-04 3.0012 1.2306E-03
3.5 0.252928631 2.53E-05 3.5016 1.5503E-03
4 -0.062124905 -6.21E-06 4.0016 1.5938E-03
4.5 -0.884719898 -8.85E-05 4.5016 1.5865E-03
5 0.60453209 6.05E-05 5.0018 1.8105E-03
5.5 0.885555689 8.86E-05 5.5019 1.9136E-03
6 1.152044805 1.15E-04 6.0020 2.0152E-03
6.5 -0.454393885 -4.54E-05 6.5019 1.9296E-03
7 2.4942719 2.49E-04 7.0023 2.2994E-03
7.5 0.627552852 6.28E-05 7.5022 2.1878E-03
8 0.026627194 2.66E-06 8.0022 2.2027E-03
8.5 0.948479894 9.48E-05 8.5024 2.3698E-03
9 0.835796235 8.36E-05 9.0024 2.4336E-03
9.5 -0.426371668 -4.26E-05 9.5024 2.3824E-03
10 0.357750047 3.58E-05 10.0025 2.5358E-03];

ftrue = data(:,1);
random_numbers = data(:,2);
wa = data(:,3);
fmeas = data(:,4);
deltaf = data(:,5);
ba = 1.0E-3;
sa = 1.5E-4;
sigma = 1E-4;


% compute
fmeas = ba + (1+sa)*ftrue+wa;
deltaf = fmeas - ftrue;









